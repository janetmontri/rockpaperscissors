<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <script>
      //   HELPER FUNCTIONS

      // Prompt user. Format input to first capital and rest lowercase.
      function promptPlayer(aPrompt) {
        let lowercaseAll = prompt(aPrompt).toLowerCase();
        return lowercaseAll.charAt(0).toUpperCase() + lowercaseAll.slice(1);
      }

      //  Alert player that their choice is invalid.
      function checkValidity(selection, arr, aPrompt) {
        while (!arr.includes(selection)) {
          selection = promptPlayer(aPrompt);
        }
        return selection;
      }

      // Randomly choose amongst rock, paper, or scissors.
      function generateRandomPlay(length) {
        return Math.floor(Math.random() * length);
      }

      //   Print user's play.
      function printPlayerMove(player) {
        console.log("You played " + player + ".");
      }

      //   Print computer's play.
      function printCompMove(computer) {
        console.log("Computer played " + computer + ".");
      }

      // Test to check if validUserInput and computerSelection are the same. If true, declare a tie and prompt for new play.
      //   function checkSame(player, computer, arr, aPrompt) {
      //     if (player === computer) {
      //       player = checkValidity(promptPlayer(aPrompt), arr);
      //       return player;
      //     }
      //   }

      // Test to see if user wins round.
      function checkWin(validUserInput, computerSelection) {
        if (
          (validUserInput === "Rock" && computerSelection === "Scissors") ||
          (validUserInput === "Scissors" && computerSelection === "Paper") ||
          (validUserInput === "Paper" && computerSelection === "Rock")
        ) {
          console.log(
            "You win! " + validUserInput + " beats " + computerSelection + "."
          );
        }
      }

      // Test to see if user loses round.
      function checkLoss(validUserInput, computerSelection) {
        if (
          (computerSelection === "Rock" && validUserInput === "Scissors") ||
          (computerSelection === "Scissors" && validUserInput === "Paper") ||
          (computerSelection === "Paper" && validUserInput === "Rock")
        ) {
          console.log(
            "You lose! " + computerSelection + " beats " + validUserInput + "."
          );
        }
      }

      //   LOGIC OF GAME PLAY

      function main() {
        //   Define array of play choices.
        var choiceArray = ["Rock", "Paper", "Scissors"];

        // Define prompts.
        var firstPrompt = "Choose rock, paper, or scissors.";

        var secondPrompt =
          "Invalid choice.  Try again.  Choose rock, paper, or scissors.";

        let done = false;

        // Play until you're out of the tie loop
        while (!done) {
          // First, prompt user to input either rock, paper, or scissors.
          var userInput = promptPlayer(firstPrompt);

          //   Make sure user's input is a valid play.
          var validUserInput = checkValidity(
            userInput,
            choiceArray,
            secondPrompt
          );

          //   Print the user's valid play.
          printPlayerMove(validUserInput);

          //  Computer plays.
          var computerSelection =
            choiceArray[generateRandomPlay(choiceArray.length)];

          //   Print the computer's play.
          printCompMove(computerSelection);

          // Check for ties.
          if (!(validUserInput === computerSelection)) {
            done = true;
          } else {
            console.log("It's a tie.  Play again.");
          }
        }

        // Check if user won.
        checkWin(validUserInput, computerSelection);

        // Check if user lost.
        checkLoss(validUserInput, computerSelection);
      }

      main();
      main();
      main();
      main();
      main();

      // Play 5 rounds.  Display winner --best 3 out of 5 rounds-- at the end.
    </script>
  </body>
</html>
