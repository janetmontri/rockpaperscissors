<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <script>
      //   HELPER FUNCTIONS

      // Prompt user. Format input to first capital and rest lowercase.
      function promptPlayer(aPrompt) {
        let lowercaseAll = prompt(aPrompt).toLowerCase();
        return lowercaseAll.charAt(0).toUpperCase() + lowercaseAll.slice(1);
      }

      //  Alert player that their choice is invalid.
      function checkValidity(user, arr, aPrompt) {
        while (!arr.includes(user)) {
          user = promptPlayer(aPrompt);
        }
        return user;
      }

      // Randomly choose amongst rock, paper, or scissors.
      function generateRandom(length) {
        return Math.floor(Math.random() * length);
      }

      //   Print user's play.
      function printUserMove(user) {
        console.log("You played " + user + ".");
      }

      //   Print computer's play.
      function printCompMove(comp) {
        console.log("Computer played " + comp + ".");
      }

      // Test to see if user wins round.
      function didIWin(user, comp) {
        if (
          (user === "Rock" && comp === "Scissors") ||
          (user === "Scissors" && comp === "Paper") ||
          (user === "Paper" && comp === "Rock")
        ) {
          return true;
        } else {
          return false;
        }
      }

      //   GAME PLAY

      function main() {
        //   Define array of play choices.
        let choiceArray = ["Rock", "Paper", "Scissors"];

        // Define prompts.
        let firstPrompt = "Choose rock, paper, or scissors.";
        let invalidPrompt =
          "Invalid choice.  Try again.  Choose rock, paper, or scissors.";

        let done = false;

        // Loop this until result is not a tie
        while (!done) {
          // Prompt user to input either rock, paper, or scissors
          let userInput = promptPlayer(firstPrompt);

          //   Make sure user's input is a valid play
          var validUserInput = checkValidity(
            userInput,
            choiceArray,
            invalidPrompt
          );

          //   Print the user's valid play
          printUserMove(validUserInput);

          //  Computer plays
          var compInput = choiceArray[generateRandom(choiceArray.length)];

          //   Print the computer's play
          printCompMove(compInput);

          // Check for ties
          if (!(validUserInput === compInput)) {
            done = true;
          } else {
            console.log("It's a tie.  Play again.");
          }
        }

        // Did user win or lose?
        let win = didIWin(validUserInput, compInput);

        // Calculate results
        if (win === true) {
          ++userScore;
          console.log(
            "You win! " + validUserInput + " beats " + compInput + "."
          );
        } else if (win === false) {
          ++compScore;
          console.log(
            "You lose! " + compInput + " beats " + validUserInput + "."
          );
        }
      }

      //   LOGIC FLOW

      let userScore = 0;
      let compScore = 0;

      for (i = 0; i < 5; i++) {
        main();
        console.log("Score: " + userScore + " \- " + compScore);
      }

      if (userScore > compScore) {
        console.log("You win, best out of 5 rounds!");
      } else {
        console.log("Better luck next time!");
      }

      // Play 5 rounds.  Display winner --best 3 out of 5 rounds-- at the end.
    </script>
  </body>
</html>
